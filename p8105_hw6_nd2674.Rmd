---
title: "Homework 6"
author: Nikhita Damaraju
output: github_document
---

This is my solution to Homework 6.

Library imports 

```{r settings, message = FALSE} 
library(tidyverse)
library(dplyr)
library(stringr)
library(ggplot2)


theme_set(theme_bw() + theme(legend.position = "bottom"))
options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)
scale_colour_discrete = scale_color_viridis_d
scale_fill_discrete = scale_fill_viridis_d

# setting seed value
set.seed(1)
```

## Problem 1

```{r message = FALSE}
homicide_df = 
  read_csv('./datasets/homicide-data.csv')
```



## Problem 2

**Loading and cleaning dataset**

```{r message = FALSE}
weight_df = 
  read_csv('./datasets/birthweight.csv') %>%
  mutate(
    babysex = as.factor(case_when(
      babysex == 1 ~ 'male',
      babysex == 2 ~ 'female'
    )),
    
    frace = as.factor(case_when(
      frace == 1 ~ 'White',
      frace == 2 ~ 'Black',
      frace == 3 ~ 'Asian',
      frace == 4 ~ 'Puerto Rican',
      frace == 8 ~ 'Other',
      frace == 9 ~ 'Unknown')),
    
    mrace = as.factor(case_when(
      mrace == 1 ~ 'White',
      mrace == 2 ~ 'Black',
      mrace == 3 ~ 'Asian',
      mrace == 4 ~ 'Puerto Rican',
      mrace == 8 ~ 'Other',
      mrace == 9 ~ 'Unknown')),
    
    malform = as.factor(case_when(
      malform == 0 ~ 'absent',
      malform == 1 ~ 'present'
    ))
  ) %>%
  drop_na()
```

The dataset consisting of weights of children has 20 variables out of which, 4 variables - `babysex`, `frace`, `mrace` and `malform` are categorical. There are no missing values in the dataset and it consists of `r nrow(weight_df)` rows.

### Linear model

**Identifying predictors of interest**

For categorical variables, based on previous studies, there is an indication that maternal ethnicity can influence the weight of the baby. For numerical variables, we look at the correlation with the outcome to identify variables that are independent correlating with the outcome. We also omit variables `pnulbw` and `pnumsga` due to large number of values with 0.

```{r}
# Selecting numerical variables 
weight_df %>%
  select(-c(babysex, frace, mrace, malform, pnumlbw, pnumsga)) %>%
  cor() %>% round(digits = 2) %>% knitr::kable()
```

Based on the results above, we pick our predictors as - bhead, blength, ga_weeks, wtgain, babysex, mrace

**Linear model**

```{r}

```



**Model residuals against fitted values**


### Comparison of model with other models 



## Problem 3

Reading data

```{r message = FALSE}
weather_df = 
  rnoaa::meteo_pull_monitors(
    c("USW00094728"),
    var = c("PRCP", "TMIN", "TMAX"), 
    date_min = "2017-01-01",
    date_max = "2017-12-31") %>%
  mutate(
    name = recode(id, USW00094728 = "CentralPark_NY"),
    tmin = tmin / 10,
    tmax = tmax / 10) %>%
  select(name, id, everything())
```

